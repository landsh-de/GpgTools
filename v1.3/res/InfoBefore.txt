 --- Veit Berwig --- GpgTools (Release-Notes) --- 20210627

Soundtrack:
================================================

    Original Soundtrack "Cover me(tme)" by Harold Geslain (1997).
    Original lyrics by BJORK.
    
    Samples came from:
    Bjork, StOtE, Astradyne, Stereoman,
    Wipeout-Xl, Coldcut.
                              Special thanks to All the NOISE-Gang ...
    Source:
    ftp://ftp.modland.com/pub/modules/Impulsetracker/Harry/

================================================
Hinweise und Anmerkungen zu der gegenwärtigen Implementierung der
Gpg4Win-Suite und der mit dieser Nachinstallation ("GpgTools")
durchgeführten Änderungen:

Installation:
================================================
Diese Installation installiert eine globale zentrale gehärtete
Konfiguration für "Gpg4Win", sowie Fehlerbehebungen in den Dialogen
von "Pinentry" und den Übersetzungstabellen von GnuPG, GpgEX und
GpgOL. Des Weiteren werden Werkzeuge installiert, die die Nutzer-
Konfiguration im Nutzerkontext bei Anmeldung vordefinieren.
Die Ausführungs-Policy für entsprechende Programme von "Gpg4Win"
wird in den lokalen Applocker-Richtlinien bei Installation
umgesetzt.

################################################
Info zur Installation
################################################

Unbeaufsichtigte Installation (SILENT)

Benutzen Sie die Option "/VERYSILENT /BASSSOUND-" anstatt "/SILENT"
für eine vollständig verborgene Installation !!

Installation inkl. Policy Einträge:
(DEFAULT)
================================================
[Installer.exe] /LANG=German /TYPE=fullpol /SILENT /NORESTART
[Installer.exe] /LANG=German /TYPE=fullpol /SILENT /NORESTART /LOG

Installation kompakt inkl. Policy Einträge:
================================================
[Installer.exe] /LANG=German /TYPE=compactpol /SILENT /NORESTART
[Installer.exe] /LANG=German /TYPE=compactpol /SILENT /NORESTART /LOG

Installation ohne Policy Einträge:
================================================
[Installer.exe] /LANG=German /TYPE=full /SILENT /NORESTART
[Installer.exe] /LANG=German /TYPE=full /SILENT /NORESTART /LOG

Installation kompakt ohne Policy Einträge:
================================================
[Installer.exe] /LANG=German /TYPE=compact /SILENT /NORESTART
[Installer.exe] /LANG=German /TYPE=compact /SILENT /NORESTART /LOG


Gpg4Win:
================================================

Die Windows Version von "Gpg4Win" wird nach gegenwärtigen Stand
auf einem Unix-System erstellt und nicht auf einem Windows-System.
Funktionen werden teilweise in externe Dateien ausgelagert.

"Gpg4Win" ist eine Zusammenstellung einzelner Programme, die sich
abhängig von ihrer Funktion gegenseitig aufrufen.

Folgende "Konfigurationen" und "Fehlerbehebungen" werden von
"GpgTools" umgesetzt:

1) Anpassung "pinentry" (Basis- und Win32-Variante)

   Aufgrund von Ressourcefehlern in der Basis- und Win32-Variante von
   "pinentry", wurden die Ressourcen der Dialoge und die
   Ressource-Texte bereinigt. Diese Versionen besitzen ebenfalls
   Übersetzungsfehler bzw. Fehler bei der Umsetzung von UTF-8 nach OEM
   Zeichensätzen. Die QT-Version ist davon nicht betroffen.

   In "pinentry-basic.exe" und "pinentry-w32.exe" wurden Ressourcen
   und Dialoge angepasst und ins Deutsche übersetzt.
 
2) Anpassung "GpgEX" / GnuPG Übersetzungsdateien (.mo)

   Nicht maskierte Steuerzeichen und Dialogformatierungen wurden
   teilweise bereinigt.

3) Das GpgEX-Kontext-Menü "Mehr GpgEX Optionen" im Explorer ist
   irreführend und wurde ersetzt: 
   
   Die Übersetzung in der .po-Datei von GpgEX wurde auf
   "GnuPG Optionen" geändert.

4) Damit Kleopatra keine Updates selbstständig durchführt und
   auch keine Hinweise darauf anzeigt, wird eine Datei
   "kleopatrarc" in das Installationsverzeichnis nachinstalliert.
   
5) Vorinstallierte Wurzel-Zertifikate der Verwaltungs-PKI,
   sowie des Bundes und der Länder werden inklusive einer mit OpenSSL
   erzeugten "Trust-Liste" vorkonfiguriert zur Verfügung gestellt.

6) Der "YubiKey 5 NFC" ist für Gpg4Win bereits in der Konfiguration
   vorkonfiguriert, damit dieser korrekt erkannt wird. Die Treiber
   müssen nocht nachinstalliert werden. Hierzu bitte das Dokument:
   "GnuPG_Yubikey-Support.txt" lesen (für die Administration).

7) Die Vorlage für VS-NfD wurde gehärtet (4096 Bit RSA-Schlüssel, 
   etc.) und in der Konfiguration aktiviert.

8) Für den Fall, dass sich einige Komponenten von Gpg4Win
   "aufhängen" wird das Werkzeug "Gpg4Win_beenden.exe"
   bereitgestellt, welches mit einem Aufruf ALLE Gpg4Win-Prozesse
   beenden kann; gleichzeitig werden relevante "Sockets"
   zurückgesetzt.

9) Genutzt wird jetzt das globale Konfigurationsverzeichnis,
   in dem alle gehärteten Konfigurationen von Gpg4Win bereits
   vorkonfiguriert abgelegt sind:
   
         %SYSTEMDRIVE%\ProgramData\GNU\etc\gnupg\

                           --- *** ---

Fehler, bzw. noch nicht optimierte Prozesse, die noch vorhanden sind.
(Stand 06/2021):

- Wird mit einem Administrativen Konto gearbeitet, kann es durch
  Problemen bei der Socket-Verarbeitung von "gpg-agent" zu Timing-
  Problemen und somit beim ersten Start von "Kleopatra" zu einem
  längeren Starverhalten beim Anzeigen der Zertifikate kommen.
  
  Hintergrund:
  
  Der "Gpg-Agent" hat Probleme einen schon im Dateisystem
  existierenden "Socket" für IPC (Inter-Process-Communication) erneut
  zu öffnen bzw. zu "kreieren" wenn dieser schon existiert (von
  einer vorherigen Sitzung) ...
  Da in dieser Zeit (bis zu einem internen Timeout-Schwellwert) der
  "Gpg-Agent" keine Anfragen entgegen nimmt, erhalten die Prozesse
  "gpg.exe" (OpenPGP-Zertifikate-Agent) und "gpgsm.exe"
  (X.509-Zertifikate-Agent) einen RPC-Fehler bei der
  Interprozesskommunikation. Wenn in diesem Moment von dem Programm
  "GpgEX" (Explorer-Erweiterung) oder dem Outlook-Plugin "GpgOL"
  eine Anfrage durchgeführt wird, bricht dieses mit einer
  Fehlermeldung ab. 
  
  Workaround:
  
  Das Programm "Gpg4Win_beenden.exe" behebt diesen Fehler, indem es
  beim Login des Benutzers alle "Gpg4Win"-Prozesse beendet und die
  nutzerbasierten "Sockets" des "Gpg-Agent" löscht.

  Da der Programm-Code aufgrund von BSI VS-NfD-Vorgaben nicht
  verändert werden darf, beschränken sich die "Fehlerbehebungen" noch
  existierender Fehler auf Ressourcen-Anpassungen und Anpassungen
  der Übersetzungstabellen der einzelnen Programme, wenn diese
  Fehler beinhalten, sowie auf die Nutzung sebstentwickelter
  Werkzeuge.

- Schlüssel (.asc) werden ohne Rückfrage importiert, ohne vorher 
  Sicherheits-Abfragen mit Details zu den Schlüsseln anzubieten.

- Es werden noch immer nur Kurze Schlüssel-IDs in entscheidenden 
  Feldern angezeigt, obwohl die globale gnupg.conf die Anzeige
  langer IDs aktiviert hat.

- Fehlermeldung bei Kommunikation von GpgEX mit Kleopatra, wenn es 
  noch nicht bereit ist (keine Interprozesskommunikation).

- Kleopatra stürzt beim Entschlüsseln grösserer Archive 
  (verschlüsselte Ordner ab ca. 1GB Grösse) ab.
  ==> Anm.: dieser Fehler wurde nach Information aus den Release-Notes
  mit der Version 3.1.16 behoben.

- Kleopatra stürzt beim Verschlüsseln grösserer Archive 
  (verschlüsselte Ordner ab ca. 1GB Grösse) ab (Speicherfehler).
  ==> Anm.: dieser Fehler wurde nach Information aus den Release-Notes
  mit der Version 3.1.16 behoben.
  
- Kleopatra hängt sich beim Beglaubigen abgelaufener Schlüssel auf.

- Skalierungs-Fehler in Windows-Dialogen (Kleopatra).

- Nicht maskierte Steuerzeichen in Windows-Dialogen
  (Kleopatra/GpgEX).
  ==>> Anm.: behoben mit GpgTools.
  
- Fehler in der Dimensionierung der Dialog-Ressourcen 
  (Dialogfelder zu klein für deutsche Texte).
  ==>> Anm.: behoben mit GpgTools.

- Das Prüfsummen-Tool erstellt Prüfsummendateien mit enthaltenen 
  absoluten Pfadnamen zu den geprüften Dateien (kein "chdir" in 
  den Zielpfad vor Prüfung). Bei einer Verlagerung der Dateien 
  und ihrer Prüfsummendatei, schlägt der Prüfsummentest fehl, 
  da die Dateien nicht mehr gefunden werden.

- Fehlerhafte Umsetzung von Feld-Trennern in Prüfsummen-Dateien: 
  Die vom Prüfsummen-Tool erstellten Prüfsummendateien besitzen 
  2 Leerzeichen als Feld-Trenner zwischen Prüfsumme und dem 
  Datei-Objekt. Wird ein Leerzeichen entfernt, so wird keine 
  Prüfsumme mehr erkannt und von dem Datei-Objektnamen wird 
  der 1.-te Buchstabe abgeschnitten.

- GpgOL: Unvollständige deutsche Übersetzung.
  ==>> Anm.: behoben mit GpgTools.

- GpgOL: Fehlerhafte Zeichen in deutscher Übersetzung.
  ==>> Anm.: behoben mit GpgTools.

- GpgOL: Wird ein verschlüsselter Anhang (.pgp/.gpg) in einer 
  Mail doppelt geklickt (öffnen), so wird bei Anwahl 
  "Alles Speichern" keine Dialog-Abfrage durchgeführt 
  WO GESPEICHERT WERDEN SOLL. Es wird ohne Rückfrage in das
  temporäre Outlook-Verzeichnis gespeichert/extrahiert:
  "%USERPROFILE%\AppData\Local\Microsoft\Windows\INetCache\
  Content.Outlook\XXXXXXXX\"

- Global: Grundsätzlich wird in den Ordner entschlüsselt, 
  in dem die Quelle existiert. Es ist nicht möglich einen 
  Zielordner anzugeben.

- Die Schrift-Skalierung in Kleopatra orientiert sich nicht
  an der Windows-Skalierung (QT-Bibliothek). Die Schriften
  sind für Sehbehinderte zu klein und können nicht grösser
  skaliert werden (fall jemand hier eine Idee hat, bitte
  eine Rückmeldung) ...

--- To be continued ---
